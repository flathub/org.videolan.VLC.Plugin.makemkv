{
  "id": "org.videolan.VLC.Plugin.makemkv",
  "build-extension": true,
  "runtime": "org.videolan.VLC",
  "runtime-version": "stable",
  "branch": "3-21.08",
  "sdk": "org.freedesktop.Sdk//21.08",
  "tags": ["proprietary"],
  "separate-locales": false,
  "appstream-compose": false,
  "build-options": {
    "env": {
      "V": "1"
    }
  },
  "modules": [
    {
      "name": "wget",
      "no-autogen": true,
      "config-opts": [
        "--prefix=/app/share/vlc/extra/makemkv"
      ],
      "sources": [
        {
            "type": "archive",
            "url": "https://ftp.gnu.org/gnu/wget/wget-1.20.3.tar.gz",
            "sha256": "31cccfc6630528db1c8e3a06f6decf2a370060b982841cfab2b8677400a5092e"
        }
      ]
    },
    {
      "name": "makemkv-bin",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p tmp",
        "echo accepted > tmp/eula_accepted",
        "make PREFIX=/app/share/vlc/extra/makemkv install",
        "install -Dp -m 644 src/eula_en_linux.txt --target-directory=/app/share/vlc/extra/makemkv/share/licenses"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "http://www.makemkv.com/download/makemkv-bin-1.16.5.tar.gz",
          "sha256": "a06e1ef1e2442b8490b783030c5c16cac2d6404525632234c04d032961f724f8"
        }
      ]
    },
    {
      "name": "makemkv-oss",
      "config-opts": [
        "--with-pic",
        "--enable-shared",
        "--disable-static",
        "--disable-gui",
        "DESTDIR=/",
        "--prefix=/app/share/vlc/extra/makemkv"
      ],
      "post-install": [
        "install -Dp -m 644 License.txt --target-directory=/app/share/vlc/extra/makemkv/share/licenses",
        "install -Dp -m 644 org.videolan.VLC.Plugin.makemkv.appdata.xml --target-directory=${FLATPAK_DEST}/share/appdata",
        "appstream-compose --basename=org.videolan.VLC.Plugin.makemkv --prefix=${FLATPAK_DEST} --origin=flatpak org.videolan.VLC.Plugin.makemkv"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "http://www.makemkv.com/download/makemkv-oss-1.16.5.tar.gz",
          "sha256": "e58e34b3ce95462bc38a242a120692c2b4e56c5a98e57cce372931ff486c3b8c"
        },
        {
          "type": "file",
          "path": "org.videolan.VLC.Plugin.makemkv.appdata.xml"
        }
      ]
    },
    {
      "name": "envvars",
      "buildsystem": "simple",
      "build-commands": [
        "mv makemkv-env.sh /app/share/vlc/extra/makemkv"
      ],
      "sources": [
        {
          "type": "file",
          "path": "makemkv-env.sh"
        }
      ]
    }
  ]
}
